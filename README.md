# Rosemary

This web application allows users to scrape recipes from different websites and store them in one place.

## Demo

https://github.com/user-attachments/assets/e7c3d292-f000-401c-af50-ed1d830f3527

## Features

- Recipe importing via URL
- Recipe CRUD
- Recipe printing
- Recipe filtering using it's title

## Build with

- Vue.js
- PrimeVue
- Tailwind CSS
- Cheerio
- Supabase
- Phosphor Icons

## Run Locally

1. Clone the project

```bash
  git clone https://github.com/KozaPawel/rosemary
```

2. Go to the project directory

```bash
  cd rosemary
```

3. Install dependencies

```bash
  npm install
```

4. Create new supabase project

5. Setup database schema

```sql
create table recipes (
  id int8 generated by default as identity not null primary key,
  created_at timestamp with time zone default now() not null,
  user_id uuid default auth.uid() not null,
  title text not null,
  description text,
  servings text,
  cook_time text,
  prep_time text,
  recipe_url text,
  ingredients text,
  instructions text,
  image text,

  constraint title_length check (length(title) > 0)
);

alter table recipes
  enable row level security;

create policy "Enable select for users based on user_id" on recipes
  as permissive for select using ((SELECT auth.uid() AS uid) = user_id);

create policy "Enable insert for authenticated users only" on recipes
  as permissive for insert to authenticated with check (true);

create policy "Enable update for users based on user_id" on recipes
  as permissive for update using ((SELECT auth.uid() AS uid) = user_id);

create policy "Enable delete for users based on user_id" on recipes
  as permissive for delete using ((SELECT auth.uid() AS uid) = user_id);
```

6. Add edge function (name it scrape)

```ts
import 'jsr:@supabase/functions-js/edge-runtime.d.ts';

Deno.serve(async (req) => {
  console.log(req.method);
  if (req.method === 'OPTIONS') {
    return new Response('ok', {
      headers: {
        'Access-Control-Allow-Origin': '*',
        'Access-Control-Allow-Methods': 'POST',
        'Access-Control-Expose-Headers': 'Content-Length, X-JSON',
        'Access-Control-Allow-Headers':
          'apikey, X-Client-Info, Content-Type, Authorization, Accept, Accept-Language, X-Authorization',
      },
    });
  } else {
    const { url } = await req.json();
    const response = await fetch(url);
    const data = await response.text();
    return new Response(JSON.stringify(data), {
      headers: {
        'Content-Type': 'application/json',
        'Access-Control-Allow-Origin': '*',
        'Access-Control-Allow-Methods': 'POST',
        'Access-Control-Expose-Headers': 'Content-Length, X-JSON',
        'Access-Control-Allow-Headers':
          'apikey, X-Client-Info, Content-Type, Authorization, Accept, Accept-Language, X-Authorization',
      },
    });
  }
});
```

7. Create and fill .env file based on .env.example

8. Start the server

```bash
  npm run dev
```
